<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Contenedor Spring</title>
	
	<meta name="author" content="Franky Villadiego">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/assets/css/style.css" rel="stylesheet">

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
</head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/eljaviador">
				<i class="fa fa-github"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="http://twitter.com/villadiegofj">
				<i class="fa fa-twitter"></i>
			</a>
			
			
			<a class="navbar-brand" href="/">
				<img src="http://www.gravatar.com/avatar/?s=35" class="img-circle" />
				
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/">Home</a></li>
				<li><a href="/categories.html">Categories</a></li>
				<li><a href="/tags.html">Tags</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/"><i class="fa fa-home"></i>Home</a></li>
			<li><a href="/categories.html"><i class="fa fa-folder"></i>Categories</a></li>
			<li><a href="/tags.html"><i class="fa fa-tags"></i>Tags</a></li>
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<div class="col-sm-3 sidebar hidden-xs">
		<! -- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/">
		<img src="http://www.gravatar.com/avatar/?s=150" class="img-circle" />
	</a>
	<h3 class="title">
        <a href="/"></a>
    </h3>
</header>


<div id="bio" class="text-center">
	Volando hacia el desarrollo productivo!
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/eljaviador">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/villadiegofj">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		
		
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		
		
		<li>
			<a class="btn btn-default btn-sm" href="/feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>
</div>
<! -- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
  <h1>Contenedor Spring </h1>
</div>
	
<article>

	<div class="col-sm-10">
	 <span class="post-date">
	   
	   July 
	   13th,
	   
	   2014
	 </span>
	  <div class="article_body">
	  <p>No voy a entrar en detalles teóricos sobre <strong>Spring</strong> ya que en los dos últimos artículos hablamos sobre <em>Inyección de Dependencias</em> <em>y Contenedores</em>. Mencionare los conceptos adicionales necesarios para conocer mejor Spring framework. </p>

<p>Spring básicamente permite hacer uso del paradigma de <em>IoC</em>(Inversión del Control) que ya habíamos visto.
En el artículo anterior vimos una lista de pasos para usar un contenedor en nuestra aplicación. Son los siguientes:</p>

<ol>
  <li>Indicamos un punto de arranque para nuestra aplicación, un lanzador.</li>
  <li>Este lanzador carga o inicia el contenedor.</li>
  <li>El contenedor carga la configuración de nuestros objetos y dependencias.</li>
  <li>Le pedimos al contenedor que nos proporcione nuestra aplicación.</li>
</ol>

<p>Usaremos las mismas clases del artículo anterior, <strong>Office</strong>, <strong>Printer</strong>, <strong>DotMatrixPrinter</strong> y <strong>Main</strong>.</p>

<p> </p>

<h2 id="usando-el-api-de-spring">Usando el API de Spring</h2>

<p>El core de Spring a través de la interface <strong><em>BeanFactory</em></strong> proporciona todas las características de <em>IoC e Inyección de Dependencias</em>. La clase principal que implementa esta interface es <strong>DefaultListableBeanFactory</strong>. Esta sera nuestro “<em>Container</em>”.</p>

<p>Spring no solo es un simple contenedor para inyectar dependencias, también ofrece otras características y servicios como <em>transaccionalidad</em>, <em>AOP</em>, <em>eventos</em>, <em>soporte i18n</em>, <em>contextos</em> y mas. Para esto Spring extiende el <em>BeanFactory</em> con la interface <em>ApplicationContext</em> de la que hablaremos pronto.</p>

<p>Spring framework posee muchos modulos, pero aqui solo vamos a usar dos. El modulo core y el modulo beans. Las dependencias maven necesarias solo son:</p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="lineno">1</span> <span class="nt">&lt;dependency&gt;</span>
<span class="lineno">2</span>    <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
<span class="lineno">3</span>    <span class="nt">&lt;artifactId&gt;</span>spring-beans<span class="nt">&lt;/artifactId&gt;</span>
<span class="lineno">4</span>    <span class="nt">&lt;version&gt;</span>4.0.5.RELEASE<span class="nt">&lt;/version&gt;</span>
<span class="lineno">5</span> <span class="nt">&lt;/dependency&gt;</span></code></pre></div>

<p> </p>

<p>Manualmente se necesita agregar al proyecto los siguientes jars:</p>

<ul>
  <li>spring-core-4.0.5.RELEASE.jar</li>
  <li>spring-beans-4.0.5.RELEASE.jar</li>
  <li>commons-logging-1.1.3.jar</li>
</ul>

<p> </p>

<h3 id="paso-1-punto-de-arranque">Paso 1, punto de arranque</h3>

<p>Nuestro punto de inicio o lanzador será un clase <strong>Main</strong> igual que el ejemplo del artículo anterior.</p>

<h3 id="paso-2-el-lanzador-inicia-el-contenedor">Paso 2, el lanzador inicia el contenedor</h3>

<p>Aquí usamos la clase de Spring que indicamos anteriormente, <strong>DefaultListableBeanFactory</strong>.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="lineno">1</span> <span class="n">DefaultListableBeanFactory</span> <span class="n">container</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">DefaultListableBeanFactory</span><span class="o">();</span></code></pre></div>

<h3 id="paso-3-cargar-la-configuracin-al-contenedor">Paso 3, cargar la configuración al contenedor</h3>

<p>Aquí tenemos varios sub-pasos, primero debemos especificar nuestra configuración. Spring permite esto a través de un archivo de configuración xml o a través de anotaciones. Usaremos el xml y lo llamaremos <em><strong>my-beans.xml</strong></em>. 
En Spring nuestros objetos se conocen como <em>Beans</em>.</p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="lineno"> 1</span> <span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="lineno"> 2</span> <span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.springframework.org/schema/beans&quot;</span>
<span class="lineno"> 3</span>  <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
<span class="lineno"> 4</span>  <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span><span class="nt">&gt;</span>
<span class="lineno"> 5</span> 
<span class="lineno"> 6</span>    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;myDotMatrixPrinter&quot;</span> <span class="na">class=</span><span class="s">&quot;com.test.spc.DotMatrixPrinter&quot;</span> <span class="nt">/&gt;</span>
<span class="lineno"> 7</span> 
<span class="lineno"> 8</span>    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;office&quot;</span> <span class="na">class=</span><span class="s">&quot;com.test.spc.Office&quot;</span><span class="nt">&gt;</span>
<span class="lineno"> 9</span>       <span class="nt">&lt;constructor-arg</span> <span class="na">ref=</span><span class="s">&quot;myDotMatrixPrinter&quot;</span> <span class="nt">/&gt;</span>
<span class="lineno">10</span>    <span class="nt">&lt;/bean&gt;</span>
<span class="lineno">11</span> 
<span class="lineno">12</span> <span class="nt">&lt;/beans&gt;</span></code></pre></div>

<p> </p>

<p>El elemento <strong>&lt;bean …&gt;</strong> permite definir mis objetos.
Ahora cargamos nuestro xml y se lo pasamos al contenedor. Usaremos clases de Spring para ayudarnos. Primero usamos un cargador de recursos con la interface <strong><em>ResourceLoader</em></strong>. Luego un lector de xml con <strong>XmlBeanDefinitionReader</strong>.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="lineno">1</span> <span class="n">ResourceLoader</span> <span class="n">resourceLoader</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">DefaultResourceLoader</span><span class="o">();</span>
<span class="lineno">2</span> <span class="n">Resource</span> <span class="n">resource</span> <span class="o">=</span> <span class="n">resourceLoader</span><span class="o">.</span><span class="na">getResource</span><span class="o">(</span><span class="s">&quot;classpath:my-beans.xml&quot;</span><span class="o">);</span>
<span class="lineno">3</span> <span class="n">XmlBeanDefinitionReader</span> <span class="n">beanDefinitionReader</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">XmlBeanDefinitionReader</span><span class="o">(</span><span class="n">container</span><span class="o">);</span>
<span class="lineno">4</span> <span class="n">beanDefinitionReader</span><span class="o">.</span><span class="na">loadBeanDefinitions</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span></code></pre></div>

<h3 id="paso-4-pedimos-nuestra-aplicacinbean-al-contenedor">Paso 4, pedimos nuestra aplicación(bean) al contenedor</h3>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="lineno">1</span> <span class="n">Office</span> <span class="n">officeBean</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="n">Office</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="lineno">2</span> <span class="n">officeBean</span><span class="o">.</span><span class="na">setMessageToPrint</span><span class="o">(</span><span class="s">&quot;Hola mundo!!&quot;</span><span class="o">);</span>
<span class="lineno">3</span> <span class="n">officeBean</span><span class="o">.</span><span class="na">print</span><span class="o">();</span></code></pre></div>

<p> </p>

<h2 id="uniendo-todo">Uniendo todo</h2>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="lineno"> 1</span> <span class="c1">//1.</span>
<span class="lineno"> 2</span> <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
<span class="lineno"> 3</span> 
<span class="lineno"> 4</span>    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
<span class="lineno"> 5</span> 
<span class="lineno"> 6</span>       <span class="c1">//2. </span>
<span class="lineno"> 7</span>       <span class="n">DefaultListableBeanFactory</span> <span class="n">container</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">DefaultListableBeanFactory</span><span class="o">();</span>
<span class="lineno"> 8</span> 
<span class="lineno"> 9</span>       <span class="c1">//3.</span>
<span class="lineno">10</span>       <span class="n">ResourceLoader</span> <span class="n">resourceLoader</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">DefaultResourceLoader</span><span class="o">();</span>
<span class="lineno">11</span>       <span class="n">Resource</span> <span class="n">resource</span> <span class="o">=</span> <span class="n">resourceLoader</span><span class="o">.</span><span class="na">getResource</span><span class="o">(</span><span class="s">&quot;classpath:my-beans.xml&quot;</span><span class="o">);</span>
<span class="lineno">12</span> 
<span class="lineno">13</span>       <span class="n">XmlBeanDefinitionReader</span> <span class="n">beanDefinitionReader</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">XmlBeanDefinitionReader</span><span class="o">(</span><span class="n">container</span><span class="o">);</span>
<span class="lineno">14</span>       <span class="n">beanDefinitionReader</span><span class="o">.</span><span class="na">loadBeanDefinitions</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
<span class="lineno">15</span> 
<span class="lineno">16</span>       <span class="c1">//4.</span>
<span class="lineno">17</span>       <span class="n">Office</span> <span class="n">officeBean</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="n">Office</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="lineno">18</span>       <span class="n">Office</span> <span class="n">officeBean2</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="n">Office</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="lineno">19</span>       <span class="n">officeBean</span><span class="o">.</span><span class="na">setMessageToPrint</span><span class="o">(</span><span class="s">&quot;Hola mundo!!&quot;</span><span class="o">);</span>
<span class="lineno">20</span>       <span class="n">officeBean</span><span class="o">.</span><span class="na">print</span><span class="o">();</span>
<span class="lineno">21</span>    <span class="o">}</span>
<span class="lineno">22</span> <span class="o">}</span></code></pre></div>

<p> </p>

<h2 id="detalles-de-configuracin-del-xml">Detalles de configuración del xml</h2>

<p>Los atributos importantes en el elemento <strong>bean</strong> son <em><strong>class</strong></em> que permite especificar la clase y el <em><strong>id</strong></em> que se usa como identificador y permite referenciar el bean en todo el xml. En esta configuración usamos la <em>inyección por constructor</em> con el elemento <strong><em>&lt;constructor-arg&gt;</em></strong> y con el atributo <em><strong>ref</strong></em> definimos cual id de bean es la dependencia.
También podemos inyectar dependencias por un método setter. De esta manera debemos usar el atributo <strong><em>&lt;property&gt;</em></strong> así:</p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="lineno">1</span> <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;printer&quot;</span> <span class="na">ref=</span><span class="s">&quot;myDotMatrix&quot;</span> <span class="nt">/&gt;</span></code></pre></div>

<p> </p>

<p>Nuestra clase <strong>Office</strong> debe definir un método setter:</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="lineno"> 1</span> <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Office</span> <span class="o">{</span>
<span class="lineno"> 2</span> 
<span class="lineno"> 3</span>    <span class="kd">private</span> <span class="n">Printer</span> <span class="n">printer</span><span class="o">;</span>
<span class="lineno"> 4</span> 
<span class="lineno"> 5</span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPrinter</span><span class="o">(</span><span class="n">Printer</span> <span class="n">printer</span><span class="o">)</span> <span class="o">{</span>
<span class="lineno"> 6</span>       <span class="k">this</span><span class="o">.</span><span class="na">printer</span> <span class="o">=</span> <span class="n">printer</span><span class="o">;</span>
<span class="lineno"> 7</span>    <span class="o">}</span>
<span class="lineno"> 8</span> 
<span class="lineno"> 9</span>    <span class="c1">//mas codigo...</span>
<span class="lineno">10</span> <span class="o">}</span></code></pre></div>

<p> </p>

<h2 id="scope">Scope</h2>

<p>Otro punto importante para entender es que Spring cada vez que le pides un bean te retorna el mismo objeto ya que por defecto crea una sola instancia de cada bean, es lo que se conoce como scope <em><strong>singleton</strong></em>. Si queremos una instancia diferente cada vez que hacemos <em><strong>getBean()</strong></em> definimos el bean como scope <em><strong>prototype</strong></em>:</p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="lineno">1</span> <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;office&quot;</span> <span class="na">class=</span><span class="s">&quot;com.test.spc.Office&quot;</span> <span class="na">scope=</span><span class="s">&quot;prototype&quot;</span><span class="nt">&gt;</span>...</code></pre></div>

<p> </p>

<h2 id="historia-de-spring">Historia de Spring</h2>

<p>Spring fue lanzado en 2004 y nació como una alternativa a las primeras versiones de <em><strong>Enterprise JavaBeans</strong></em>(EJB). Se define como un contenedor <em>liviano no intrusivo</em> ya que nuestras clases no necesitan extender ni implementar nada del framework. Cosa que si era necesaria con EJB. Y el nombre de los beans de Spring viene de Enterprise JavaBeans.</p>

	  </div>

		
		<ul class="tag_box list-unstyled list-inline">
		  <li><i class="fa fa-folder-open"></i></li>
		  
		  
			 
				<li><a href="/categories.html#arquitectura-ref">
					arquitectura <span>(3)</span>
					,
				</a></li>
			 
				<li><a href="/categories.html#framework-ref">
					framework <span>(1)</span>
					
				</a></li>
			
		  
		</ul>
		  

		  

		<hr>

		<div>
      <section class="share col-sm-6">
        <h4 class="section-title">Share Post</h4>
        <a class="btn btn-default btn-sm twitter" href="http://twitter.com/share?text=Contenedor Spring&via=villadiegofj"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <i class="fa fa-twitter fa-lg"></i>
          Twitter
        </a>
        <a class="btn btn-default btn-sm facebook" href="https://www.facebook.com/sharer/sharer.php"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-lg"></i>
          Facebook
        </a>
        <a class="btn btn-default btn-sm gplus"
           onclick="window.open('https://plus.google.com/share?url='+window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <i class="fa fa-google-plus fa-lg"></i>
          Google+
        </a>
      </section>

      <section class="col-sm-6 author">
        <img src="http://www.gravatar.com/avatar/" class="img-rounded author-image" />
        <h4 class="section-title author-name">Franky Villadiego</h4>
        <p class="author-bio">Volando hacia el desarrollo productivo!</p>
      </section>
    </div>

    <div class="clearfix"></div>

		<ul class="pager">
		  
		  <li class="previous"><a href="/arquitectura/conceptos/2014/07/11/contenedores-e-inyeccion-de-dependencias-%5Bparte-2%5D.html" title="Contenedores e Inyección de Dependencias [02]">&larr; Previous</a></li>
		  
		  
		  <li class="next"><a href="/arquitectura/javase/2014/08/31/cargador-de-clases.html" title="Cargador de clases">Next &rarr;</a></li>
		  
		</ul>

		<hr>
	</div>
	
	<div class="col-sm-2 sidebar-2">
	
	</div>
</article>
<div class="clearfix"></div>



		<footer>
			<hr/>
			<p>
				&copy; 2014 Franky Villadiego
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/assets/js/app.js"></script>
</body>
</html>

